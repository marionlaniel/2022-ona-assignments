---
title: "Exercice 2"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
library(dplyr)
library(tidygraph)
library(tidyverse)
library(igraph)
library(ggraph)
library(graphlayouts)
```

## Load Dataset
```{r}
seats <- read.csv("FacebookSeat.csv")
seats
```

## Calculating metrics
```{r, echo=FALSE}
seats <- as.matrix(seats)
seats_graph <- graph_from_edgelist(seats, directed=FALSE)
seats_graph <- simplify(seats_graph)
```
```{r}
# Degree Centrality
Degree<-degree(seats_graph, v = V(seats_graph), 
      mode = c("total"), 
      loops = TRUE, normalized = FALSE)
Degree
# Closeness Centrality
Closeness <- closeness(seats_graph)
Closeness
# Betweeness Centrality
Betweenness <- betweenness(seats_graph)
Betweenness
```

## Choice
Looking at the closeness centrality, we notice that seat B and C have the highest scores, meaning that they have the shortest distance with the other seats. However, looking at the betweeness centrality, we notice that seat A has the highest score, meaning that it is the seat with the highest level of influence for transmitting information in the network. Finally, looking at the degree centrality, we notice that nodes B, C and D have 5 links, while seat A has 3 links. Therefore, the best seat would be B, since it is closest to more seats, has good metrics for closeness and betweeness centrality.

## Plot Graph
```{r}
ggraph(seats_graph, "stress", bbox = 15) +
  geom_edge_link2(aes(edge_colour = "orange"), edge_width = 0.5) +
  geom_node_point(aes(fill = Betweenness, size = Degree), shape = 21) +
  geom_node_text(aes(label = name, size=Closeness),
    family = "serif", repel = TRUE
  ) +
  scale_edge_colour_brewer(palette = "Set1") +
  scale_size(range = c(2, 5), guide = "none") +
  theme_graph() 
```